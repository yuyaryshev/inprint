"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.inprintIndexTs = inprintIndexTs;
exports.indexTsEmbeddedFeature = void 0;

var _fs = require("fs");

var _path = require("path");

const indexTsEmbeddedFeature = {
  name: "IndexTs",
  keywords: ["index"],
  description: `Generates reexport for each file inside directory. 
Use exclude:['name1','name2'] to exclude some files. 
Use merge:[{name:'MERGE_NAME', suffix:'MERGE_SUFFIX'}] to merge exported consts with specified MERGE_SUFFIX as an array into one variable MERGE_NAME`,
  func: inprintIndexTs,
  help: `// ${"@INPRINT"}_START {exclude:[""], merge:[{name:"embeddedFeatures:EmbeddedFeature[]", suffix:"EmbeddedFeature"}]}
export * from "./indexTs.js";

import { indexTsEmbeddedFeature } from "./indexTs";
export const embeddedFeatures: EmbeddedFeature[] = [indexTsEmbeddedFeature];
// ${"@INPRINT"}_END
    `
};
exports.indexTsEmbeddedFeature = indexTsEmbeddedFeature;
const allowedExtensions = new Set(["js", "mjs", "cjs", "jsx", "ts", "tsx"]);

function inprintIndexTs(paramsObject, options) {
  if (!paramsObject.absolutePath.endsWith("/index.ts")) return undefined;
  const excludes = new Set([...((paramsObject === null || paramsObject === void 0 ? void 0 : paramsObject.excludes) || []), ...((paramsObject === null || paramsObject === void 0 ? void 0 : paramsObject.exclude) || []), ...((paramsObject === null || paramsObject === void 0 ? void 0 : paramsObject.excluding) || [])]);
  const merges = [...new Set([...((paramsObject === null || paramsObject === void 0 ? void 0 : paramsObject.merge) || [])])];
  excludes.add("index");
  const baseParts = (0, _path.resolve)(paramsObject.absolutePath.split("/").slice(0, -1).join("/"));
  const fileNames = [];

  for (let dirent of (0, _fs.readdirSync)(baseParts, {
    withFileTypes: true
  })) {
    if (dirent.isDirectory()) continue;
    const fileName = dirent.name;
    const temp = fileName.split(".");
    const ext = temp[temp.length - 1];
    if (!allowedExtensions.has(ext)) continue;
    const nameWoExt = fileName.split(".").slice(0, -1).join(".");
    if (!paramsObject.includeTests && nameWoExt.endsWith(".test")) continue;
    if (excludes.has(fileName) || excludes.has(nameWoExt)) continue;
    fileNames.push(nameWoExt);
  }

  fileNames.sort();
  const reexports = fileNames.map(f => `export * from "./${f}${options.appendJsInImports ? ".js" : ""}";`).join("\n");
  const mergeArrayBlocks = [];

  for (let mergeDefinition of merges) {
    const mergeLines = [];
    const mergeVars = [];

    for (let nameWoExt of fileNames) {
      mergeLines.push(`import {${nameWoExt}${mergeDefinition.suffix}} from "./${nameWoExt}";`);
      mergeVars.push(`${nameWoExt}${mergeDefinition.suffix}`);
    }

    mergeArrayBlocks.push(`
${mergeLines.join("\n")}
export const ${mergeDefinition.name} = [${mergeVars.join(", ")}];
`.trim());
  }

  const r = `
${reexports}

${mergeArrayBlocks.join("\n\n")}
`.trim();
  if (!r.length) return `export const unused901723 = 0; // No files found!`;
  return r;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9lbWJlZGRlZEZlYXR1cmVzL2luZGV4VHMudHMiXSwibmFtZXMiOlsiaW5kZXhUc0VtYmVkZGVkRmVhdHVyZSIsIm5hbWUiLCJrZXl3b3JkcyIsImRlc2NyaXB0aW9uIiwiZnVuYyIsImlucHJpbnRJbmRleFRzIiwiaGVscCIsImFsbG93ZWRFeHRlbnNpb25zIiwiU2V0IiwicGFyYW1zT2JqZWN0Iiwib3B0aW9ucyIsImFic29sdXRlUGF0aCIsImVuZHNXaXRoIiwidW5kZWZpbmVkIiwiZXhjbHVkZXMiLCJleGNsdWRlIiwiZXhjbHVkaW5nIiwibWVyZ2VzIiwibWVyZ2UiLCJhZGQiLCJiYXNlUGFydHMiLCJzcGxpdCIsInNsaWNlIiwiam9pbiIsImZpbGVOYW1lcyIsImRpcmVudCIsIndpdGhGaWxlVHlwZXMiLCJpc0RpcmVjdG9yeSIsImZpbGVOYW1lIiwidGVtcCIsImV4dCIsImxlbmd0aCIsImhhcyIsIm5hbWVXb0V4dCIsImluY2x1ZGVUZXN0cyIsInB1c2giLCJzb3J0IiwicmVleHBvcnRzIiwibWFwIiwiZiIsImFwcGVuZEpzSW5JbXBvcnRzIiwibWVyZ2VBcnJheUJsb2NrcyIsIm1lcmdlRGVmaW5pdGlvbiIsIm1lcmdlTGluZXMiLCJtZXJnZVZhcnMiLCJzdWZmaXgiLCJ0cmltIiwiciJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFJTyxNQUFNQSxzQkFBdUMsR0FBRztBQUNuREMsRUFBQUEsSUFBSSxFQUFFLFNBRDZDO0FBRW5EQyxFQUFBQSxRQUFRLEVBQUUsQ0FBQyxPQUFELENBRnlDO0FBR25EQyxFQUFBQSxXQUFXLEVBQUc7QUFDbEI7QUFDQSxxSkFMdUQ7QUFNbkRDLEVBQUFBLElBQUksRUFBRUMsY0FONkM7QUFPbkRDLEVBQUFBLElBQUksRUFBRyxNQUFLLFVBQVc7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLFVBQVc7QUFDaEI7QUFidUQsQ0FBaEQ7O0FBZ0JQLE1BQU1DLGlCQUFpQixH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NEJ6QixNQUE1QixFQUFvQztBQUNoQyxVQUFNMEIsVUFBVSxHQUFHLEVBQW5CO0FBQ0EsVUFBTUMsU0FBUyxHQUFHLEVBQWxCOztBQUNBLFNBQUssSUFBSVgsU0FBVCxJQUFzQlQsU0FBdEIsRUFBaUM7QUFDN0JtQixNQUFBQSxVQUFVLENBQUNSLElBQVgsQ0FBaUIsV0FBVUYsU0FBVSxHQUFFUyxlQUFlLENBQUNHLE1BQU8sYUFBWVosU0FBVSxJQUFwRjtBQUNBVyxNQUFBQSxTQUFTLENBQUNULElBQVYsQ0FBZ0IsR0FBRUYsU0FBVSxHQUFFUyxlQUFlLENBQUNHLE1BQU8sRUFBckQ7QUFDSDs7QUFDREosSUFBQUEsZ0JBQWdCLENBQUNOLElBQWpCLENBQ0s7QUFDYixFQUFFUSxVQUFVLENBQUNwQixJQUFYLENBQWdCLElBQWhCLENBQXNCO0FBQ3hCLGVBQWVtQixlQUFlLENBQUN6QyxJQUFLLE9BQU0yQyxTQUFTLENBQUNyQixJQUFWLENBQWUsSUFBZixDQUFxQjtBQUMvRCxDQUhZLENBR1Z1QixJQUhVLEVBREo7QUFNSDs7QUFFRCxRQUFNQyxDQUFDLEdBQUk7QUFDZixFQUFFVixTQUFVO0FBQ1o7QUFDQSxFQUFFSSxnQkFBZ0IsQ0FBQ2xCLElBQWpCLENBQXNCLE1BQXRCLENBQThCO0FBQ2hDLENBSmMsQ0FJWnVCLElBSlksRUFBVjtBQU1BLE1BQUksQ0FBQ0MsQ0FBQyxDQUFDaEIsTUFBUCxFQUFlLE9BQVEsbURBQVI7QUFFZixTQUFPZ0IsQ0FBUDtBQUNIIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmVhZGRpclN5bmMgfSBmcm9tIFwiZnNcIjtcbmltcG9ydCB7IHJlc29sdmUgfSBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IHsgRW1iZWRkZWRGZWF0dXJlIH0gZnJvbSBcIi4uL0VtYmVkZGVkRmVhdHVyZVwiO1xuaW1wb3J0IHsgSW5wcmludE9wdGlvbnMgfSBmcm9tIFwiLi4vSW5wcmludE9wdGlvbnNcIjtcblxuZXhwb3J0IGNvbnN0IGluZGV4VHNFbWJlZGRlZEZlYXR1cmU6IEVtYmVkZGVkRmVhdHVyZSA9IHtcbiAgICBuYW1lOiBcIkluZGV4VHNcIixcbiAgICBrZXl3b3JkczogW1wiaW5kZXhcIl0sXG4gICAgZGVzY3JpcHRpb246IGBHZW5lcmF0ZXMgcmVleHBvcnQgZm9yIGVhY2ggZmlsZSBpbnNpZGUgZGlyZWN0b3J5LiBcblVzZSBleGNsdWRlOlsnbmFtZTEnLCduYW1lMiddIHRvIGV4Y2x1ZGUgc29tZSBmaWxlcy4gXG5Vc2UgbWVyZ2U6W3tuYW1lOidNRVJHRV9OQU1FJywgc3VmZml4OidNRVJHRV9TVUZGSVgnfV0gdG8gbWVyZ2UgZXhwb3J0ZWQgY29uc3RzIHdpdGggc3BlY2lmaWVkIE1FUkdFX1NVRkZJWCBhcyBhbiBhcnJheSBpbnRvIG9uZSB2YXJpYWJsZSBNRVJHRV9OQU1FYCxcbiAgICBmdW5jOiBpbnByaW50SW5kZXhUcyxcbiAgICBoZWxwOiBgLy8gJHtcIkBJTlBSSU5UXCJ9X1NUQVJUIHtleGNsdWRlOltcIlwiXSwgbWVyZ2U6W3tuYW1lOlwiZW1iZWRkZWRGZWF0dXJlczpFbWJlZGRlZEZlYXR1cmVbXVwiLCBzdWZmaXg6XCJFbWJlZGRlZEZlYXR1cmVcIn1dfVxuZXhwb3J0ICogZnJvbSBcIi4vaW5kZXhUcy5qc1wiO1xuXG5pbXBvcnQgeyBpbmRleFRzRW1iZWRkZWRGZWF0dXJlIH0gZnJvbSBcIi4vaW5kZXhUc1wiO1xuZXhwb3J0IGNvbnN0IGVtYmVkZGVkRmVhdHVyZXM6IEVtYmVkZGVkRmVhdHVyZVtdID0gW2luZGV4VHNFbWJlZGRlZEZlYXR1cmVdO1xuLy8gJHtcIkBJTlBSSU5UXCJ9X0VORFxuICAgIGAsXG59O1xuXG5jb25zdCBhbGxvd2VkRXh0ZW5zaW9ucyA9IG5ldyBTZXQoW1wianNcIiwgXCJtanNcIiwgXCJjanNcIiwgXCJqc3hcIiwgXCJ0c1wiLCBcInRzeFwiXSk7XG5cbmV4cG9ydCBmdW5jdGlvbiBpbnByaW50SW5kZXhUcyhwYXJhbXNPYmplY3Q6IGFueSwgb3B0aW9uczogSW5wcmludE9wdGlvbnMpIHtcbiAgICBpZiAoIXBhcmFtc09iamVjdC5hYnNvbHV0ZVBhdGguZW5kc1dpdGgoXCIvaW5kZXgudHNcIikpIHJldHVybiB1bmRlZmluZWQ7XG5cbiAgICBjb25zdCBleGNsdWRlcyA9IG5ldyBTZXQoW1xuICAgICAgICAuLi4ocGFyYW1zT2JqZWN0Py5leGNsdWRlcyB8fCBbXSksXG4gICAgICAgIC4uLihwYXJhbXNPYmplY3Q/LmV4Y2x1ZGUgfHwgW10pLFxuICAgICAgICAuLi4ocGFyYW1zT2JqZWN0Py5leGNsdWRpbmcgfHwgW10pLFxuICAgIF0pO1xuXG4gICAgY29uc3QgbWVyZ2VzID0gWy4uLm5ldyBTZXQoWy4uLihwYXJhbXNPYmplY3Q/Lm1lcmdlIHx8IFtdKV0pXTtcblxuICAgIGV4Y2x1ZGVzLmFkZChcImluZGV4XCIpO1xuICAgIGNvbnN0IGJhc2VQYXJ0cyA9IHJlc29sdmUocGFyYW1zT2JqZWN0LmFic29sdXRlUGF0aC5zcGxpdChcIi9cIikuc2xpY2UoMCwgLTEpLmpvaW4oXCIvXCIpKTtcblxuICAgIGNvbnN0IGZpbGVOYW1lcyA9IFtdO1xuICAgIGZvciAobGV0IGRpcmVudCBvZiByZWFkZGlyU3luYyhiYXNlUGFydHMsIHsgd2l0aEZpbGVUeXBlczogdHJ1ZSB9KSkge1xuICAgICAgICBpZiAoZGlyZW50LmlzRGlyZWN0b3J5KCkpIGNvbnRpbnVlO1xuICAgICAgICBjb25zdCBmaWxlTmFtZSA9IGRpcmVudC5uYW1lO1xuICAgICAgICBjb25zdCB0ZW1wID0gZmlsZU5hbWUuc3BsaXQoXCIuXCIpO1xuICAgICAgICBjb25zdCBleHQgPSB0ZW1wW3RlbXAubGVuZ3RoIC0gMV07XG4gICAgICAgIGlmICghYWxsb3dlZEV4dGVuc2lvbnMuaGFzKGV4dCkpIGNvbnRpbnVlO1xuICAgICAgICBjb25zdCBuYW1lV29FeHQgPSBmaWxlTmFtZS5zcGxpdChcIi5cIikuc2xpY2UoMCwgLTEpLmpvaW4oXCIuXCIpO1xuICAgICAgICBpZiAoIXBhcmFtc09iamVjdC5pbmNsdWRlVGVzdHMgJiYgbmFtZVdvRXh0LmVuZHNXaXRoKFwiLnRlc3RcIikpIGNvbnRpbnVlO1xuICAgICAgICBpZiAoZXhjbHVkZXMuaGFzKGZpbGVOYW1lKSB8fCBleGNsdWRlcy5oYXMobmFtZVdvRXh0KSkgY29udGludWU7XG4gICAgICAgIGZpbGVOYW1lcy5wdXNoKG5hbWVXb0V4dCk7XG4gICAgfVxuICAgIGZpbGVOYW1lcy5zb3J0KCk7XG5cbiAgICBjb25zdCByZWV4cG9ydHMgPSBmaWxlTmFtZXNcbiAgICAgICAgLm1hcCgoZikgPT4gYGV4cG9ydCAqIGZyb20gXCIuLyR7Zn0ke29wdGlvbnMuYXBwZW5kSnNJbkltcG9ydHMgPyBcIi5qc1wiIDogXCJcIn1cIjtgKVxuICAgICAgICAuam9pbihcIlxcblwiKTtcblxuICAgIGNvbnN0IG1lcmdlQXJyYXlCbG9ja3MgPSBbXTtcbiAgICBmb3IgKGxldCBtZXJnZURlZmluaXRpb24gb2YgbWVyZ2VzKSB7XG4gICAgICAgIGNvbnN0IG1lcmdlTGluZXMgPSBbXTtcbiAgICAgICAgY29uc3QgbWVyZ2VWYXJzID0gW107XG4gICAgICAgIGZvciAobGV0IG5hbWVXb0V4dCBvZiBmaWxlTmFtZXMpIHtcbiAgICAgICAgICAgIG1lcmdlTGluZXMucHVzaChgaW1wb3J0IHske25hbWVXb0V4dH0ke21lcmdlRGVmaW5pdGlvbi5zdWZmaXh9fSBmcm9tIFwiLi8ke25hbWVXb0V4dH1cIjtgKTtcbiAgICAgICAgICAgIG1lcmdlVmFycy5wdXNoKGAke25hbWVXb0V4dH0ke21lcmdlRGVmaW5pdGlvbi5zdWZmaXh9YCk7XG4gICAgICAgIH1cbiAgICAgICAgbWVyZ2VBcnJheUJsb2Nrcy5wdXNoKFxuICAgICAgICAgICAgYFxuJHttZXJnZUxpbmVzLmpvaW4oXCJcXG5cIil9XG5leHBvcnQgY29uc3QgJHttZXJnZURlZmluaXRpb24ubmFtZX0gPSBbJHttZXJnZVZhcnMuam9pbihcIiwgXCIpfV07XG5gLnRyaW0oKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IHIgPSBgXG4ke3JlZXhwb3J0c31cblxuJHttZXJnZUFycmF5QmxvY2tzLmpvaW4oXCJcXG5cXG5cIil9XG5gLnRyaW0oKTtcblxuICAgIGlmICghci5sZW5ndGgpIHJldHVybiBgZXhwb3J0IGNvbnN0IHVudXNlZDkwMTcyMyA9IDA7IC8vIE5vIGZpbGVzIGZvdW5kIWA7XG5cbiAgICByZXR1cm4gcjtcbn1cbiJdfQ==