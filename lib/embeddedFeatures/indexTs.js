"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.inprintIndexTs = inprintIndexTs;
exports.indexTsEmbeddedFeature = void 0;

var _fs = require("fs");

const indexTsEmbeddedFeature = {
  name: "IndexTs",
  description: `Generates reexport for each file inside directory. 
Use exclude:['name1','name2'] to exclude some files. 
Use merge:[{name:'MERGE_NAME', suffix:'MERGE_SUFFIX'}] to merge exported consts with specified MERGE_SUFFIX as an array into one variable MERGE_NAME`,
  func: inprintIndexTs
};
exports.indexTsEmbeddedFeature = indexTsEmbeddedFeature;

function inprintIndexTs(paramsObject) {
  if (!paramsObject.absolutePath.endsWith("/index.ts")) return undefined;
  const excludes = new Set([...((paramsObject === null || paramsObject === void 0 ? void 0 : paramsObject.excludes) || []), ...((paramsObject === null || paramsObject === void 0 ? void 0 : paramsObject.exclude) || []), ...((paramsObject === null || paramsObject === void 0 ? void 0 : paramsObject.excluding) || [])]);
  const merges = [...new Set([...((paramsObject === null || paramsObject === void 0 ? void 0 : paramsObject.merge) || [])])];
  excludes.add("index");
  const baseParts = paramsObject.absolutePath.split("/").slice(0, -1).join("/");
  const fileNames = [];

  for (let fileName of (0, _fs.readdirSync)(baseParts)) {
    const nameWoExt = fileName.split(".").slice(0, -1).join(".");
    if (excludes.has(fileName) || excludes.has(nameWoExt)) continue;
    fileNames.push(nameWoExt);
  }

  fileNames.sort();
  const reexports = fileNames.map(f => `export * from "./${f}";`).join("\n");
  const mergeArrayBlocks = [];

  for (let mergeDefinition of merges) {
    const mergeLines = [];
    const mergeVars = [];

    for (let nameWoExt of fileNames) {
      mergeLines.push(`import {${nameWoExt}${mergeDefinition.suffix}} from "./${nameWoExt}";`);
      mergeVars.push(`${nameWoExt}${mergeDefinition.suffix}`);
    }

    mergeArrayBlocks.push(`
${mergeLines.join("\n")}
export const ${mergeDefinition.name} = [${mergeVars.join(", ")}];
`.trim());
  }

  return `
${reexports}

${mergeArrayBlocks.join("\n\n")}
`.trim();
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9lbWJlZGRlZEZlYXR1cmVzL2luZGV4VHMudHMiXSwibmFtZXMiOlsiaW5kZXhUc0VtYmVkZGVkRmVhdHVyZSIsIm5hbWUiLCJkZXNjcmlwdGlvbiIsImZ1bmMiLCJpbnByaW50SW5kZXhUcyIsInBhcmFtc09iamVjdCIsImFic29sdXRlUGF0aCIsImVuZHNXaXRoIiwidW5kZWZpbmVkIiwiZXhjbHVkZXMiLCJTZXQiLCJleGNsdWRlIiwiZXhjbHVkaW5nIiwibWVyZ2VzIiwibWVyZ2UiLCJhZGQiLCJiYXNlUGFydHMiLCJzcGxpdCIsInNsaWNlIiwiam9pbiIsImZpbGVOYW1lcyIsImZpbGVOYW1lIiwibmFtZVdvRXh0IiwiaGFzIiwicHVzaCIsInNvcnQiLCJyZWV4cG9ydHMiLCJtYXAiLCJmIiwibWVyZ2VBcnJheUJsb2NrcyIsIm1lcmdlRGVmaW5pdGlvbiIsIm1lcmdlTGluZXMiLCJtZXJnZVZhcnMiLCJzdWZmaXgiLCJ0cmltIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBOztBQUdPLE1BQU1BLHNCQUF1QyxHQUFHO0FBQ25EQyxFQUFBQSxJQUFJLEVBQUMsU0FEOEM7QUFFbkRDLEVBQUFBLFdBQVcsRUFBRztBQUNsQjtBQUNBLHFKQUp1RDtBQUtuREMsRUFBQUEsSUFBSSxFQUFFQztBQUw2QyxDQUFoRDs7O0FBUUEsU0FBU0EsY0FBVCxDQUF3QkMsWUFBeEIsRUFBMkM7QUFDOUMsTUFBSSxDQUFDQSxZQUFZLENBQUNDLFlBQWIsQ0FBMEJDLFFBQTFCLENBQW1DLFdBQW5DLENBQUwsRUFBc0QsT0FBT0MsU0FBUDtBQUV0RCxRQUFNQyxRQUFRLEdBQUcsSUFBSUMsR0FBSixDQUFRLENBQ3JCLElBQUksQ0FBQUwsWUFBWSxTQUFaLElBQUFBLFlBQVksV0FBWixZQUFBQSxZQUFZLENBQUVJLFFBQWQsS0FBMEIsRUFBOUIsQ0FEcUIsRUFFckIsSUFBSSxDQUFBSixZQUFZLFNBQVosSUFBQUEsWUFBWSxXQUFaLFlBQUFBLFlBQVksQ0FBRU0sT0FBZCxLQUF5QixFQUE3QixDQUZxQixFQUdyQixJQUFJLENBQUFOLFlBQVksU0FBWixJQUFBQSxZQUFZLFdBQVosWUFBQUEsWUFBWSxDQUFFTyxTQUFkLEtBQTJCLEVBQS9CLENBSHFCLENBQVIsQ0FBakI7QUFNQSxRQUFNQyxNQUFNLEdBQUcsQ0FBQyxHQUFHLElBQUlILEdBQUosQ0FBUSxDQUFDLElBQUksQ0FBQUwsWUFBWSxTQUFaLElBQUFBLFlBQVksV0FBWixZQUFBQSxZQUFZLENBQUVTLEtBQWQsS0FBdUIsRUFBM0IsQ0FBRCxDQUFSLENBQUosQ0FBZjtBQUVBTCxFQUFBQSxRQUFRLENBQUNNLEdBQVQsQ0FBYSxPQUFiO0FBQ0EsUUFBTUMsU0FBUyxHQUFHWCxZQUFZLENBQUNDLFlBQWIsQ0FBMEJXLEtBQTFCLENBQWdDLEdBQWhDLEVBQXFDQyxLQUFyQyxDQUEyQyxDQUEzQyxFQUE4QyxDQUFDLENBQS9DLEVBQWtEQyxJQUFsRCxDQUF1RCxHQUF2RCxDQUFsQjtBQUVBLFFBQU1DLFNBQVMsR0FBRyxFQUFsQjs7QUFDQSxPQUFLLElBQUlDLFFBQVQsSUFBcUIscUJBQVlMLFNBQVosQ0FBckIsRUFBNkM7QUFDekMsVUFBTU0sU0FBUyxHQUFHRCxRQUFRLENBQUNKLEtBQVQsQ0FBZSxHQUFmLEVBQW9CQyxLQUFwQixDQUEwQixDQUExQixFQUE2QixDQUFDLENBQTlCLEVBQWlDQyxJQUFqQyxDQUFzQyxHQUF0QyxDQUFsQjtBQUNBLFFBQUlWLFFBQVEsQ0FBQ2MsR0FBVCxDQUFhRixRQUFiLEtBQTBCWixRQUFRLENBQUNjLEdBQVQsQ0FBYUQsU0FBYixDQUE5QixFQUF1RDtBQUN2REYsSUFBQUEsU0FBUyxDQUFDSSxJQUFWLENBQWVGLFNBQWY7QUFDSDs7QUFDREYsRUFBQUEsU0FBUyxDQUFDSyxJQUFWO0FBRUEsUUFBTUMsU0FBUyxHQUFHTixTQUFTLENBQUNPLEdBQVYsQ0FBZUMsQ0FBRCxJQUFRLG9CQUFtQkEsQ0FBRSxJQUEzQyxFQUFnRFQsSUFBaEQsQ0FBcUQsSUFBckQsQ0FBbEI7QUFFQSxRQUFNVSxnQkFBZ0IsR0FBRyxFQUF6Qjs7QUFDQSxPQUFLLElBQUlDLGVBQVQsSUFBNEJqQixNQUE1QixFQUFvQztBQUNoQyxVQUFNa0IsVUFBVSxHQUFHLEVBQW5CO0FBQ0EsVUFBTUMsU0FBUyxHQUFHLEVBQWxCOztBQUNBLFNBQUssSUFBSVYsU0FBVCxJQUFzQkYsU0FBdEIsRUFBaUM7QUFDN0JXLE1BQUFBLFVBQVUsQ0FBQ1AsSUFBWCxDQUFpQixXQUFVRixTQUFVLEdBQUVRLGVBQWUsQ0FBQ0csTUFBTyxhQUFZWCxTQUFVLElBQXBGO0FBQ0FVLE1BQUFBLFNBQVMsQ0FBQ1IsSUFBVixDQUFnQixHQUFFRixTQUFVLEdBQUVRLGVBQWUsQ0FBQ0csTUFBTyxFQUFyRDtBQUNIOztBQUNESixJQUFBQSxnQkFBZ0IsQ0FBQ0wsSUFBakIsQ0FDSztBQUNiLEVBQUVPLFVBQVUsQ0FBQ1osSUFBWCxDQUFnQixJQUFoQixDQUFzQjtBQUN4QixlQUFlVyxlQUFlLENBQUM3QixJQUFLLE9BQU0rQixTQUFTLENBQUNiLElBQVYsQ0FBZSxJQUFmLENBQXFCO0FBQy9ELENBSFksQ0FHVmUsSUFIVSxFQURKO0FBTUg7O0FBRUQsU0FBUTtBQUNaLEVBQUVSLFNBQVU7QUFDWjtBQUNBLEVBQUVHLGdCQUFnQixDQUFDVixJQUFqQixDQUFzQixNQUF0QixDQUE4QjtBQUNoQyxDQUpXLENBSVRlLElBSlMsRUFBUDtBQUtIIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmVhZGRpclN5bmMgfSBmcm9tIFwiZnNcIjtcclxuaW1wb3J0IHsgRW1iZWRkZWRGZWF0dXJlIH0gZnJvbSBcIi4uL0VtYmVkZGVkRmVhdHVyZVwiO1xyXG5cclxuZXhwb3J0IGNvbnN0IGluZGV4VHNFbWJlZGRlZEZlYXR1cmU6IEVtYmVkZGVkRmVhdHVyZSA9IHtcclxuICAgIG5hbWU6XCJJbmRleFRzXCIsXHJcbiAgICBkZXNjcmlwdGlvbjogYEdlbmVyYXRlcyByZWV4cG9ydCBmb3IgZWFjaCBmaWxlIGluc2lkZSBkaXJlY3RvcnkuIFxyXG5Vc2UgZXhjbHVkZTpbJ25hbWUxJywnbmFtZTInXSB0byBleGNsdWRlIHNvbWUgZmlsZXMuIFxyXG5Vc2UgbWVyZ2U6W3tuYW1lOidNRVJHRV9OQU1FJywgc3VmZml4OidNRVJHRV9TVUZGSVgnfV0gdG8gbWVyZ2UgZXhwb3J0ZWQgY29uc3RzIHdpdGggc3BlY2lmaWVkIE1FUkdFX1NVRkZJWCBhcyBhbiBhcnJheSBpbnRvIG9uZSB2YXJpYWJsZSBNRVJHRV9OQU1FYCxcclxuICAgIGZ1bmM6IGlucHJpbnRJbmRleFRzLFxyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGlucHJpbnRJbmRleFRzKHBhcmFtc09iamVjdDogYW55KSB7XHJcbiAgICBpZiAoIXBhcmFtc09iamVjdC5hYnNvbHV0ZVBhdGguZW5kc1dpdGgoXCIvaW5kZXgudHNcIikpIHJldHVybiB1bmRlZmluZWQ7XHJcblxyXG4gICAgY29uc3QgZXhjbHVkZXMgPSBuZXcgU2V0KFtcclxuICAgICAgICAuLi4ocGFyYW1zT2JqZWN0Py5leGNsdWRlcyB8fCBbXSksXHJcbiAgICAgICAgLi4uKHBhcmFtc09iamVjdD8uZXhjbHVkZSB8fCBbXSksXHJcbiAgICAgICAgLi4uKHBhcmFtc09iamVjdD8uZXhjbHVkaW5nIHx8IFtdKSxcclxuICAgIF0pO1xyXG5cclxuICAgIGNvbnN0IG1lcmdlcyA9IFsuLi5uZXcgU2V0KFsuLi4ocGFyYW1zT2JqZWN0Py5tZXJnZSB8fCBbXSldKV07XHJcblxyXG4gICAgZXhjbHVkZXMuYWRkKFwiaW5kZXhcIik7XHJcbiAgICBjb25zdCBiYXNlUGFydHMgPSBwYXJhbXNPYmplY3QuYWJzb2x1dGVQYXRoLnNwbGl0KFwiL1wiKS5zbGljZSgwLCAtMSkuam9pbihcIi9cIik7XHJcblxyXG4gICAgY29uc3QgZmlsZU5hbWVzID0gW107XHJcbiAgICBmb3IgKGxldCBmaWxlTmFtZSBvZiByZWFkZGlyU3luYyhiYXNlUGFydHMpKSB7XHJcbiAgICAgICAgY29uc3QgbmFtZVdvRXh0ID0gZmlsZU5hbWUuc3BsaXQoXCIuXCIpLnNsaWNlKDAsIC0xKS5qb2luKFwiLlwiKTtcclxuICAgICAgICBpZiAoZXhjbHVkZXMuaGFzKGZpbGVOYW1lKSB8fCBleGNsdWRlcy5oYXMobmFtZVdvRXh0KSkgY29udGludWU7XHJcbiAgICAgICAgZmlsZU5hbWVzLnB1c2gobmFtZVdvRXh0KTtcclxuICAgIH1cclxuICAgIGZpbGVOYW1lcy5zb3J0KCk7XHJcblxyXG4gICAgY29uc3QgcmVleHBvcnRzID0gZmlsZU5hbWVzLm1hcCgoZikgPT4gYGV4cG9ydCAqIGZyb20gXCIuLyR7Zn1cIjtgKS5qb2luKFwiXFxuXCIpO1xyXG5cclxuICAgIGNvbnN0IG1lcmdlQXJyYXlCbG9ja3MgPSBbXTtcclxuICAgIGZvciAobGV0IG1lcmdlRGVmaW5pdGlvbiBvZiBtZXJnZXMpIHtcclxuICAgICAgICBjb25zdCBtZXJnZUxpbmVzID0gW107XHJcbiAgICAgICAgY29uc3QgbWVyZ2VWYXJzID0gW107XHJcbiAgICAgICAgZm9yIChsZXQgbmFtZVdvRXh0IG9mIGZpbGVOYW1lcykge1xyXG4gICAgICAgICAgICBtZXJnZUxpbmVzLnB1c2goYGltcG9ydCB7JHtuYW1lV29FeHR9JHttZXJnZURlZmluaXRpb24uc3VmZml4fX0gZnJvbSBcIi4vJHtuYW1lV29FeHR9XCI7YCk7XHJcbiAgICAgICAgICAgIG1lcmdlVmFycy5wdXNoKGAke25hbWVXb0V4dH0ke21lcmdlRGVmaW5pdGlvbi5zdWZmaXh9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG1lcmdlQXJyYXlCbG9ja3MucHVzaChcclxuICAgICAgICAgICAgYFxyXG4ke21lcmdlTGluZXMuam9pbihcIlxcblwiKX1cclxuZXhwb3J0IGNvbnN0ICR7bWVyZ2VEZWZpbml0aW9uLm5hbWV9ID0gWyR7bWVyZ2VWYXJzLmpvaW4oXCIsIFwiKX1dO1xyXG5gLnRyaW0oKVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGBcclxuJHtyZWV4cG9ydHN9XHJcblxyXG4ke21lcmdlQXJyYXlCbG9ja3Muam9pbihcIlxcblxcblwiKX1cclxuYC50cmltKCk7XHJcbn1cclxuIl19